/**
 * @license ev-em.js v3.4.4 (Google One Tap more conf - 12:07 CEST - 2 May 2023)
 * (c) 2015-2023 Evolok, Inc. https://www.evolok.com/
 *
 * License: MIT
 */
var runtime=function(a){"use strict";var u,t=Object.prototype,h=t.hasOwnProperty,r="function"==typeof Symbol?Symbol:{},n=r.iterator||"@@iterator",e=r.asyncIterator||"@@asyncIterator",o=r.toStringTag||"@@toStringTag";function i(t,r,e){return Object.defineProperty(t,r,{value:e,enumerable:!0,configurable:!0,writable:!0}),t[r]}try{i({},"")}catch(t){i=function(t,r,e){return t[r]=e}}function c(t,r,e,n){var o,i,a,c,r=r&&r.prototype instanceof d?r:d,r=Object.create(r.prototype),n=new j(n||[]);return r._invoke=(o=t,i=e,a=n,c=l,function(t,r){if(c===p)throw new Error("Generator is already running");if(c===y){if("throw"===t)throw r;return k()}for(a.method=t,a.arg=r;;){var e=a.delegate;if(e){var n=function t(r,e){var n=r.iterator[e.method];if(n===u){if(e.delegate=null,"throw"===e.method){if(r.iterator.return&&(e.method="return",e.arg=u,t(r,e),"throw"===e.method))return v;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return v}var n=f(n,r.iterator,e.arg);if("throw"===n.type)return e.method="throw",e.arg=n.arg,e.delegate=null,v;n=n.arg;if(!n)return e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,v;{if(!n.done)return n;e[r.resultName]=n.value,e.next=r.nextLoc,"return"!==e.method&&(e.method="next",e.arg=u)}e.delegate=null;return v}(e,a);if(n){if(n===v)continue;return n}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if(c===l)throw c=y,a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);c=p;n=f(o,i,a);if("normal"===n.type){if(c=a.done?y:s,n.arg!==v)return{value:n.arg,done:a.done}}else"throw"===n.type&&(c=y,a.method="throw",a.arg=n.arg)}}),r}function f(t,r,e){try{return{type:"normal",arg:t.call(r,e)}}catch(t){return{type:"throw",arg:t}}}a.wrap=c;var l="suspendedStart",s="suspendedYield",p="executing",y="completed",v={};function d(){}function g(){}function m(){}var w={};w[n]=function(){return this};r=Object.getPrototypeOf,r=r&&r(r(O([])));r&&r!==t&&h.call(r,n)&&(w=r);var L=m.prototype=d.prototype=Object.create(w);function x(t){["next","throw","return"].forEach(function(r){i(t,r,function(t){return this._invoke(r,t)})})}function b(a,c){var r;this._invoke=function(e,n){function t(){return new c(function(t,r){!function r(t,e,n,o){t=f(a[t],a,e);if("throw"!==t.type){var i=t.arg;return(e=i.value)&&"object"==typeof e&&h.call(e,"__await")?c.resolve(e.__await).then(function(t){r("next",t,n,o)},function(t){r("throw",t,n,o)}):c.resolve(e).then(function(t){i.value=t,n(i)},function(t){return r("throw",t,n,o)})}o(t.arg)}(e,n,t,r)})}return r=r?r.then(t,t):t()}}function E(t){var r={tryLoc:t[0]};1 in t&&(r.catchLoc=t[1]),2 in t&&(r.finallyLoc=t[2],r.afterLoc=t[3]),this.tryEntries.push(r)}function _(t){var r=t.completion||{};r.type="normal",delete r.arg,t.completion=r}function j(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(E,this),this.reset(!0)}function O(r){if(r){var t=r[n];if(t)return t.call(r);if("function"==typeof r.next)return r;if(!isNaN(r.length)){var e=-1,t=function t(){for(;++e<r.length;)if(h.call(r,e))return t.value=r[e],t.done=!1,t;return t.value=u,t.done=!0,t};return t.next=t}}return{next:k}}function k(){return{value:u,done:!0}}return((g.prototype=L.constructor=m).constructor=g).displayName=i(m,o,"GeneratorFunction"),a.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===g||"GeneratorFunction"===(t.displayName||t.name))},a.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,m):(t.__proto__=m,i(t,o,"GeneratorFunction")),t.prototype=Object.create(L),t},a.awrap=function(t){return{__await:t}},x(b.prototype),b.prototype[e]=function(){return this},a.AsyncIterator=b,a.async=function(t,r,e,n,o){void 0===o&&(o=Promise);var i=new b(c(t,r,e,n),o);return a.isGeneratorFunction(r)?i:i.next().then(function(t){return t.done?t.value:i.next()})},x(L),i(L,o,"Generator"),L[n]=function(){return this},L.toString=function(){return"[object Generator]"},a.keys=function(e){var t,n=[];for(t in e)n.push(t);return n.reverse(),function t(){for(;n.length;){var r=n.pop();if(r in e)return t.value=r,t.done=!1,t}return t.done=!0,t}},a.values=O,j.prototype={constructor:j,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=u,this.done=!1,this.delegate=null,this.method="next",this.arg=u,this.tryEntries.forEach(_),!t)for(var r in this)"t"===r.charAt(0)&&h.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=u)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function t(t,r){return i.type="throw",i.arg=e,n.next=t,r&&(n.method="next",n.arg=u),!!r}for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r],i=o.completion;if("root"===o.tryLoc)return t("end");if(o.tryLoc<=this.prev){var a=h.call(o,"catchLoc"),c=h.call(o,"finallyLoc");if(a&&c){if(this.prev<o.catchLoc)return t(o.catchLoc,!0);if(this.prev<o.finallyLoc)return t(o.finallyLoc)}else if(a){if(this.prev<o.catchLoc)return t(o.catchLoc,!0)}else{if(!c)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return t(o.finallyLoc)}}}},abrupt:function(t,r){for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e];if(n.tryLoc<=this.prev&&h.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var o=n;break}}var i=(o=o&&("break"===t||"continue"===t)&&o.tryLoc<=r&&r<=o.finallyLoc?null:o)?o.completion:{};return i.type=t,i.arg=r,o?(this.method="next",this.next=o.finallyLoc,v):this.complete(i)},complete:function(t,r){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&r&&(this.next=r),v},finish:function(t){for(var r=this.tryEntries.length-1;0<=r;--r){var e=this.tryEntries[r];if(e.finallyLoc===t)return this.complete(e.completion,e.afterLoc),_(e),v}},catch:function(t){for(var r=this.tryEntries.length-1;0<=r;--r){var e=this.tryEntries[r];if(e.tryLoc===t){var n,o=e.completion;return"throw"===o.type&&(n=o.arg,_(e)),n}}throw new Error("illegal catch attempt")},delegateYield:function(t,r,e){return this.delegate={iterator:O(t),resultName:r,nextLoc:e},"next"===this.method&&(this.arg=u),v}},a}("object"==typeof module?module.exports:{});try{regeneratorRuntime=runtime}catch(t){Function("r","regeneratorRuntime = r")(runtime)}
"use strict";function _typeof(e){return(_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function _toConsumableArray(e){return _arrayWithoutHoles(e)||_iterableToArray(e)||_unsupportedIterableToArray(e)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArray(e){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),e}function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&_setPrototypeOf(e,t)}function _createSuper(n){var r=_isNativeReflectConstruct();return function(){var e,t=_getPrototypeOf(n);return _possibleConstructorReturn(this,r?(e=_getPrototypeOf(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments))}}function _possibleConstructorReturn(e,t){return!t||"object"!==_typeof(t)&&"function"!=typeof t?_assertThisInitialized(e):t}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _wrapNativeSuper(e){var n="function"==typeof Map?new Map:void 0;return(_wrapNativeSuper=function(e){if(null===e||!_isNativeFunction(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==n){if(n.has(e))return n.get(e);n.set(e,t)}function t(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(t,e)})(e)}function _construct(e,t,n){return(_construct=_isNativeReflectConstruct()?Reflect.construct:function(e,t,n){var r=[null];r.push.apply(r,t);r=new(Function.bind.apply(e,r));return n&&_setPrototypeOf(r,n.prototype),r}).apply(null,arguments)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],function(){})),!0}catch(e){return!1}}function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}function _setPrototypeOf(e,t){return(_setPrototypeOf=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function _getPrototypeOf(e){return(_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function _slicedToArray(e,t){return _arrayWithHoles(e)||_iterableToArrayLimit(e,t)||_unsupportedIterableToArray(e,t)||_nonIterableRest()}function _nonIterableRest(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _iterableToArrayLimit(e,t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(e){i=!0,o=e}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}function _arrayWithHoles(e){if(Array.isArray(e))return e}function asyncGeneratorStep(e,t,n,r,i,o,a){try{var s=e[o](a),l=s.value}catch(e){return void n(e)}s.done?t(l):Promise.resolve(l).then(r,i)}function _asyncToGenerator(s){return function(){var e=this,a=arguments;return new Promise(function(t,n){var r=s.apply(e,a);function i(e){asyncGeneratorStep(r,t,n,i,o,"next",e)}function o(e){asyncGeneratorStep(r,t,n,i,o,"throw",e)}i(void 0)})}}function _createForOfIteratorHelper(e,t){var n,r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=_unsupportedIterableToArray(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var i=0,t=function(){};return{s:t,n:function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}},e:(r=function(e){throw e},o.toString=function(){return r.toString()},o),f:t}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function o(e){return r.apply(this,arguments)}var a,s,l=!0,c=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return l=e.done,e},e:(s=function(e){c=!0,a=e},u.toString=function(){return s.toString()},u),f:function(){try{l||null==n.return||n.return()}finally{if(c)throw a}}};function u(e){return s.apply(this,arguments)}}function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ownKeys(t,e){var n,r=Object.keys(t);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(t),e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)),r}function _objectSpread(t){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?ownKeys(Object(n),!0).forEach(function(e){_defineProperty(t,e,n[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ownKeys(Object(n)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(n,e))})}return t}function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}window.EV=window.EV||{},function(G){var r,F,u,d,o,m=new w,a=new w,n=!1,i=0,s=0,p={};window.addEventListener("ev.widgets.dwelltime.enabled",function(e){e.detail.dwellTimeTrackingEnabled&&(n=!0,s=e.detail.maxDwellTimeRequests||3,setTimeout(function(){G.Em.initDwellTimeRequests(p.authorizeData)},1e3))});var l,t,c=(l="evolok.api.service",function(e){var t;if(!e||0===e.trim().length)throw new Error("Could not find the service name or key!");return G.Em.secureModeEnabled&&(t=q("ex_ss"))?"Evolok "+l+"="+e+" evolok.api.secureSessionId="+t:(t=q("ev_ss"),"Evolok "+l+"="+e+" evolok.api.sessionId="+t)});function h(){u&&(F.disableCookies||j("ev_sid")==u||(f("ev_sid",u),b("ev_sid",u,0,"localStorage"))),d&&(F.disableCookies||j("ev_did")==d||(f("ev_did",d),b("ev_did",d,0,"localStorage")))}function j(e){for(var t=(t=document.cookie).split("; "),n={},r=0;r<t.length;r++){var i=t[r].split("=");n[i[0]]=i[1]}return n[e]||""}G.Em={Event:{AD_AUTHORIZE:"ev.ad.authorize",PROFILE_ACCESS_RENDER_STATUS:"ev.ad.profile.access.render.status",GET_USER_PROFILE_SUCCESS:"ev.ad.get.user.profile.success",GET_USER_PROFILE_FAIL:"ev.ad.get.user.profile.fail",UPDATE_PROFILE_SUCCESS:"ev.em.profile.update.success",UPDATE_PROFILE_FAIL:"ev.em.profile.update.fail",GET_PROFILE_TEMPLATE_SUCCESS:"ev.em.profile.template.get.success",GET_PROFILE_TEMPLATE_FAIL:"ev.em.profile.template.get.fail",GET_PROFILE_DATA_SUCCESS:"ev.em.profile.data.get.success",GET_PROFILE_DATA_FAIL:"ev.em.profile.data.get.fail",DWELLTIME_CHECK:"ev.ad.dwelltime.check",DWELLTIME_WIDGETS_ENABLED:"ev.widgets.dwelltime.enabled",PAYWALL_MODAL_RENDERED:"ev.em.paywall.modal.rendered",NOTIFIER_MODAL_RENDERED:"ev.em.notifier.modal.rendered",PAYWALL_OPENED:"ev.em.paywall.opened",NOTIFIER_OPENED:"ev.em.notifier.opened",PAYWALL_SHOW_CTA:"ev.em.paywall.showCTA",NOTIFIER_SHOW_CTA:"ev.em.notifier.showCTA",PAYWALL_RENDER_READY:"ev.em.paywall.render.ready",NOTIFIER_RENDER_READY:"ev.em.notifier.render.ready",NOTIFIER_CLOSE:"ev.em.notifier.close",ARTICLE_DATA:"ev.em.article.data",ARTICLE_URL:"ev.em.article.url",CLOSE_ARTICLE_SHARING_MODAL:"ev.em.close.article.sharing.modal",SHARE_ARTICLE_SUCCESS:"ev.em.share.article.success",SHARE_ARTICLE_ERROR:"ev.em.share.article.error",OPEN_PRODUCT_SELECTION:"ev.em.open.product.selection",PRODUCT_SELECTION_LOADED:"ev.em.product.selection.loaded",SOCIAL_LOGIN_SUCCESS:"ev.em.social.login.success",SOCIAL_LOGIN_FAILED:"ev.em.social.login.failed",SESSION_REFRESH:"ev.em.session.refresh",SESSION_SAVED:"ev.em.user.session.saved",IDENTITY_LINK_AUTHENTICATION:"ev.em.identity.link.authentication",SOCIALS_LINK_AUTHENTICATION:"ev.em.socials.link.authentication",SOCIAL_LOGIN_ATTEMPTED_EXISTING_EMAIL:"social.login.existing.email.attempted",SOCIAL_LOGIN_ATTEMPTED_REQUIRES_AUTHENTICATION:"social.login.existing.email.authentication.required",USER_IDENTIFIED:"ev.em.user.identified",LOGOUT_SUCCESS:"ev.em.logout.success",LOGOUT_FAILED:"ev.em.logout.failed",SESSION_EXPIRED:"ev.em.session.expired"},on:function(e,t){window.addEventListener(e,t)},publish:function(e,t){var n;"function"==typeof CustomEvent?n=new CustomEvent(e,{detail:t}):(n=document.createEvent("CustomEvent")).initCustomEvent(e,!1,!1,{detail:t}),window.dispatchEvent(n)},shareArticle:function(t){var e=j("ev_ss")||j("ev_ss"),n="".concat(F.pmUrl,"/widget/account/sharearticle?ev_ss=").concat(e),e={articleUrl:t.articleUrl,articleId:t.articleId,recipientEmail:t.email};fetch(n,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)}).then(function(e){200===e.status?e.json().then(function(e){G.Em.publish(G.Em.Event.CLOSE_ARTICLE_SHARING_MODAL,{}),G.Em.publish(G.Em.Event.SHARE_ARTICLE_SUCCESS,_objectSpread(_objectSpread({},e),{},{metadata:t.metadata}))}):e.json().then(function(e){return G.Em.publish(G.Em.Event.SHARE_ARTICLE_ERROR,e)})}).catch(function(e){G.Em.publish(G.Em.Event.SHARE_ARTICLE_ERROR,e),console.log(e)})},init:function(e){if(!e.url)throw"Configuration must specify the url property!";e.hasOwnProperty("brand")&&(this.brand=e.brand),e.hasOwnProperty("channel")&&(this.channel=e.channel),e.hasOwnProperty("realmName")&&(this.realmName=e.realmName),e.hasOwnProperty("serviceName")&&(this.serviceName=e.serviceName),e.hasOwnProperty("socialServiceName")&&(this.socialServiceName=e.socialServiceName),e.hasOwnProperty("secureModeEnabled")&&(this.secureModeEnabled=e.secureModeEnabled),e.hasOwnProperty("autoRegister")&&(this.autoRegister=e.autoRegister),e.hasOwnProperty("autoPopulate")&&(this.autoPopulate=e.autoPopulate),e.hasOwnProperty("socialAttributeMapping")&&(this.socialAttributeMapping=e.socialAttributeMapping),e.hasOwnProperty("ssoCookieDomain")&&(this.ssoCookieDomain=e.ssoCookieDomain),e.hasOwnProperty("enableSeamlessMode")&&(this.enableSeamlessMode=e.enableSeamlessMode),e.hasOwnProperty("disableCookies")&&(this.disableCookies=e.disableCookies),e.hasOwnProperty("qrCodeQueryParam")?this.qrCodeQueryParam=e.qrCodeQueryParam:this.qrCodeQueryParam="evAccessToken",e.hasOwnProperty("shareArticleTokenQueryParam")?this.shareArticleTokenQueryParam=e.shareArticleTokenQueryParam:this.shareArticleTokenQueryParam="shareArticleToken",e.hasOwnProperty("articleUrlKey")?this.articleUrlKey=e.articleUrlKey:this.articleUrlKey="article_url",e.hasOwnProperty("articleIdKey")?this.articleIdKey=e.articleIdKey:this.articleIdKey="articleId",e.hasOwnProperty("enableGoogleOneTap")&&!0===e.enableGoogleOneTap&&(e.hasOwnProperty("realmName")||e.hasOwnProperty("socialServiceName")&&e.hasOwnProperty("serviceName")?e.hasOwnProperty("googleClientId")?(this.googleClientId=e.googleClientId,this.enableGoogleOneTap=e.enableGoogleOneTap,this.googleGenericConf=e.googleGenericConf,G.Em.initGoogleApis()):(console.warn("Impossible to initialize Google One Tap. Check that you have setup correctly the `googleClientId`"),delete e.enableGoogleOneTap):(console.warn("Impossible to initialize Google One Tap. Check that you have setup correctly: `realmName`, `socialServiceName` / `serviceName`"),delete e.enableGoogleOneTap)),e.hasOwnProperty("authSchemeName")&&(this.authSchemeName=e.authSchemeName),e.hasOwnProperty("autoLinkLoginRedirectUrl")&&(this.autoLinkLoginRedirectUrl=e.autoLinkLoginRedirectUrl),e.hasOwnProperty("autoLinkLoginRedirectAutomatic")?this.autoLinkLoginRedirectAutomatic=e.autoLinkLoginRedirectAutomatic:this.autoLinkLoginRedirectAutomatic=!0,e.hasOwnProperty("icDomain")&&(this.icDomain=e.icDomain),e.hasOwnProperty("GTMDataLayerEnabled")&&(this.GTMDataLayerEnabled=e.GTMDataLayerEnabled),e.hasOwnProperty("enableDwellTime")&&(this.enableDwellTime=e.enableDwellTime),(F=e).icDomain&&F.serviceName&&G.Em.getUserProfileData(),G.Event&&G.Event.on(G.Event.USER_SESSION_SAVED,function(){G.Em.getUserProfileData()})},initGoogleApis:function(){var e=function(e){for(var t=e+"=",n=decodeURIComponent(document.cookie).split(";"),r=0;r<n.length;r++){for(var i=n[r];" "==i.charAt(0);)i=i.substring(1);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return""}("ev_ss");function n(e){var t,n,r;console.log("Google One Tap Response",e),e.network="google",t=G.Em.socialServiceName||G.Em.serviceName,n=G.Em.autoRegister||!0,r=G.Em.autoPopulate||!1,function(n,r,i,o,a){return new Promise(function(e,t){!function(t,u,e,n,r,i,d,m){var p=t.network;if(t.hasOwnProperty("error")||t.hasOwnProperty("code")){var o=v(t,u,p);m(o)}else{var h,r={autoRegister:r||!0,autoPopulate:i||!1};if(t.hasOwnProperty("credential")){Object.assign(t,{jwt:t.credential}),h=t,Object.assign(h,{realmName:e}),Object.assign(h,{serviceName:n});var a=[];if(i&&G.Em.socialAttributeMapping){for(var s in G.Em.socialAttributeMapping){s={name:s,value:G.Em.socialAttributeMapping[s]};a.push(s)}Object.assign(h,{attributesMapping:a})}G.Em.brand&&(h.brand=G.Em.brand),G.Em.channel&&(h.channel=G.Em.channel);var E,r="https://".concat(G.Em.icDomain,"/social/").concat(p,"/session?autoRegister=").concat(r.autoRegister,"&autoPopulate=").concat(r.autoPopulate),n={Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8",Authorization:c(n)};fetch(r,{method:"POST",headers:n,body:JSON.stringify(h)}).then(function(e){return E=t.headers,e.json()}).then(function(e){var t,n,r,i,o,a,s,l,c;e.hasOwnProperty("error")||e.hasOwnProperty("code")||400<=u?(e.googleOneTap=h,function(e){if(e&&e.code&&"SOCIAL_EMAIL_ADDRESS_IN_USE"===e.code){var t,n={};if(n.googleOneTap=e.googleOneTap,n.identifiers=[{name:e.args[0],value:e.args[1]}],e.args&&(1===(r=e.args[2].split(",")).length&&""===r[0]?(r=[],G.Em.publish("hide.social",{networks:r}),n.hideSocial={networks:r},G.Em.publish(G.Em.Event.IDENTITY_LINK_AUTHENTICATION),G.Em.publish(G.Em.Event.USER_IDENTIFIED,n.identifiers)):(t="true"===e.args[3],r=r.map(function(e){return e.toLowerCase()}),t?(G.Em.publish(G.Em.Event.IDENTITY_LINK_AUTHENTICATION),G.Em.publish("user.identified.with.socials",{networks:r}),G.Em.publish(G.Em.Event.USER_IDENTIFIED,n.identifiers)):(1<r.length?(G.Em.publish(G.Em.Event.SOCIALS_LINK_AUTHENTICATION,r),n.socialLinkAuthentication=r):G.Em.publish(r[0]+".link.authentication"),G.Em.publish("hide.ic.login",{networks:r}),n.hideIcLogin={networks:r}))),e.network="google",n.socialNetwork=e.network,n.socialLoginAttempted=!0,!G.Em.authSchemeName){var r="EV.Em.init() is not provided with an authSchemeName attribute, impossible to proceed with Social Linking to existing account.";return console.error(r),G.Em.publish(G.Em.Event.SOCIAL_LOGIN_FAILED,r)}b("ev_auth_scheme",G.Em.authSchemeName,0,"sessionStorage"),b("google_one_tap_attempted",JSON.stringify(n),0,"sessionStorage"),G.Em.autoLinkLoginRedirectAutomatic&&G.Em.autoLinkLoginRedirectUrl?(console.info("Redirecting user to authenticate with Evolok before doing Social Linking"),window.location.href=G.Em.autoLinkLoginRedirectUrl):G.Em.publish(G.Em.Event.SOCIAL_LOGIN_ATTEMPTED_REQUIRES_AUTHENTICATION,{socialNetwork:e.network})}G.Em.publish(G.Em.Event.SOCIAL_LOGIN_FAILED,e)}(e),a=v(e,u,p),m(a)):(t=e).hasOwnProperty("guid")&&(n=!1,t.hasOwnProperty("mainSession")&&(n=t.mainSession.hasOwnProperty("sessionCookie")?t.mainSession.sessionCookie:n,r=t.mainSession.hasOwnProperty("expiry")?t.mainSession.expiry:new Date),i=!1,!G.Em.enableSeamlessMode||(a=E?E.get("X-EV-SSO"):void 0)&&(s=t,l=a,c=i=!0,new Promise(function(e,t){G.Em.assert(l,"Seamless domains should not be empty!"),G.Em.assert(s,"Session should not be empty!"),l=l.split(",");var n=c?"https://":"http://",r=0;function i(){r===l.length&&e()}l.forEach(function(e){var t=n+e+"/ic/api/session/"+s.mainSession.sessionId+"/sso.gif",e=new XMLHttpRequest;e.open("GET",t),e.withCredentials=!0,e.send(),e.onload=function(){r++,i()},e.onerror=function(){r++,i()}})}).then(function(){o=f(t,n,r,e,p,u),d(o)})),i||(o=f(t,n,r,e,p,u),d(o)))}).catch(function(e){console.error("Social login failed",e),G.Em.publish(G.Em.Event.SOCIAL_LOGIN_FAILED,e.message)})}else m("Credentials from Google One Tap response weren't found. Impossible to create User Session.")}}(a,null,n,r,i,o,e,t)})}(G.Em.realmName,t,n,r,e).then(function(e){G.Em.publish(G.Em.Event.SOCIAL_LOGIN_SUCCESS,e)},function(e){console.error("Social login error",e)}).catch(function(e){console.log("Error during social login",e)})}function f(e,t,n,r,i,o){return function(e,t,n,r){G.Em.assert(e,"Evolok session should not be empty!");var i="ev_session",o=G.Em.ssoCookieDomain||window.location.hostname;r||(!G.Em.disableCookies&&e&&e.hasOwnProperty("mainSession")&&a("ev_ss",e.mainSession.sessionId,{expireMillis:e.mainSession.expiry||n,domain:o}),!G.Em.disableCookies&&G.Em.secureModeEnabled&&e.hasOwnProperty("secureSession")&&a("ex_ss",e.secureSession.sessionId,{expireMillis:e.secureSession.expiry||n,domain:o}));(t?sessionStorage:localStorage).setItem(i,JSON.stringify(e));G.Em.publish(G.Em.Event.SESSION_SAVED,"session saved")}(e,t,n),G.Em.publish(G.Em.Event.SESSION_REFRESH,e),{network:i,statusCode:o,response:r}}function a(e,t,n){if(!navigator.cookieEnabled)throw Error("cookies are disabled");if(n=n||{},!e)throw Error("invalid key");t=e+"="+t;if(n.expireMillis&&((r=new Date).setTime(n.expireMillis),t+="; time="+new Date+"; expires="+r.toGMTString()),n.domain&&n.domain!==document.domain){var r=n.domain.replace(/^\./,"");if(-1===document.domain.indexOf(r)||r.split(".").length<=1)throw Error("invalid domain");t+="; domain="+n.domain}n=y();document.cookie=n&&n<13?t+"; path=/; Secure":t+"; path=/;SameSite=None; Secure"}function v(e,t,n){if(!e)return e;t={network:n,statusCode:t,error:{}};return e.hasOwnProperty("code")?(t.error.code=e.code,t.error.message=e.message):e.hasOwnProperty("error")?t.error=e.error:t.error=e,e.hasOwnProperty("args")&&(t.error.args=e.args),t}e&&""!==e?console.info("User is logged in, Google One Tap will be skipped",e):((e=document.createElement("script")).src="https://accounts.google.com/gsi/client",e.onload=function(){!function(){var e={client_id:F.googleClientId,callback:n};if(null!==F.googleGenericConf)for(var t in F.googleGenericConf)e[t]=F.googleGenericConf[t];google.accounts.id.initialize(e),google.accounts.id.prompt(function(e){console.log("Goole One Tap Notification",e),e.isNotDisplayed()?console.info("Google One Tap is not being displayed",e):e.isSkippedMoment()&&console.info("Google One Tap was skipped",e)})}()},e.defer=!0,document.body.appendChild(e))},getEVSession:function(){var e="evolok:ev_session",t=localStorage.getItem(e);return(t=null==t||0===t.length?sessionStorage.getItem(e)?sessionStorage.getItem(e):j(e):t)&&0<t.length?JSON.parse(t):null},logout:function(){return new Promise(function(e,t){var n,r,i=G.Em.getEVSession();S("ev_ss"),S("ex_ss"),i&&(n=G.Em.socialServiceName||G.Em.serviceName,r=window.location.protocol+"//"+window.location.host,r={Accept:"application/json;charset=UTF-8","Content-Type":"application/json;charset=UTF-8",Authorization:c(n),Origin:r},G.Em.deleteSession(i.mainSession.sessionId,r,null,e,t))})},deleteSession:function(e,t,n,r,i){G.Em.assert(e,"Session ID should not be empty!");e="https://".concat(F.icDomain,"/session/").concat(e);function o(e){G.Em.publish(G.Em.Event.LOGOUT_SUCCESS,e),r(e)}G.Em.delete(e,t,n).then(function(e){if(e.hasOwnProperty("statusCode")&&200==e.statusCode)if(G.Em.clearAllSessions(),G.Em.removeUserProfile(),G.Em.enableSeamlessMode){var t=e.headers?e.headers.get("X-EV-SSO"):void 0;if(!t)throw o(),new Error("Couldn't find the participating seamless sign-in domains");G.Em.deleteSeamlessSession(t,!0).then(function(){o(e)})}else o(e);else o(e)},function(e){"SESSION_NOT_FOUND"==e.error.code?(G.Em.clearAllSessions(),G.Em.removeUserProfile(),o(e)):i(e)})},deleteSeamlessSession:function(o,a){return new Promise(function(e,t){G.Em.assert(o,"Seamless domains should not be empty!"),o=o.split(",");var n=a?"https://":"http://",r=0;function i(){r===o.length&&e()}o.forEach(function(e){var t=n+e+"/ic/api/session/sso_logout.gif",e=new XMLHttpRequest;e.open("GET",t),e.withCredentials=!0,e.send(),e.onload=function(){r++,i()},e.onerror=function(){r++,i()}})})},delete:function(t,n,e,r){return new Promise(function(o,a){G.Em.assert(t,"Http request resource uri path should not be empty!"),G.Em.isValid();var s,l,e=r||{};r&&r.hasOwnProperty("serviceName")?e.serviceName=r.serviceName:(e.serviceName=G.Em.socialServiceName||G.Em.serviceName,e.realmName=G.Em.realmName),n=n||{},fetch(t,{method:"DELETE",headers:n}).then(function(e){return l=e.headers,s=e.status,200===e.status?e.text():void G.Em.publish(G.Em.Event.LOGOUT_FAILED,{status:e.status})}).then(function(e){if(e.error||e.code){var t=s,n=e.code,r=e.message||e.error&&e.error.message||e,i=[];return"SESSION_HAS_EXPIRED"===e.code&&(G.Em.clearAllSessions(),G.Em.removeUserProfile(),G.Event.publish(G.Em.SESSION_EXPIRED,"Session has expired.")),e.hasOwnProperty("args")?i=e.args:e.hasOwnProperty("error")&&(i=e.error.args),void a({code:n,message:r,statusCode:t,args:i})}o({response:e,statusCode:s,headers:l})}).catch(function(e){console.error("Logout failed",e),G.Em.publish(G.Em.Event.LOGOUT_FAILED,e)})})},clearAllSessions:function(){G.Em.removeEVSession()},removeUserProfile:function(){sessionStorage.removeItem("ev_profile")},removeEVSession:function(){var e="ev_session";sessionStorage.removeItem(e),localStorage.removeItem(e),S("ev_ss"),S("ex_ss");localStorage.removeItem("hello")},isValid:function(){if(!F.icDomain)throw new Error("Config must specify the icDomain property");if(!G.Em.detectBrowserSupport())throw console.error("Not Compatible with current browser!"),new Error("Not Compatible with current browser!")},detectBrowserSupport:function(){var e="withCredentials"in new XMLHttpRequest;return e||console.error("Error running EV: your browser does not support CORS."),e},getAuthResponse:function(){return m.promise},getSegmentResponse:function(){return a.promise},getUserProfileTemplate:function(){fetch("https://".concat(F.domainName,"/ic/api/ui/template/profile/").concat(F.profileServiceName),{method:"GET",headers:{"Content-Type":"application/json"}}).then(function(e){return 200===e.status?e.json():void G.Em.publish(G.Em.Event.GET_PROFILE_TEMPLATE_FAIL,e.status)}).then(function(e){G.Em.publish(G.Em.Event.GET_PROFILE_TEMPLATE_SUCCESS,e)}).catch(function(e){return G.Em.publish(G.Em.Event.GET_PROFILE_TEMPLATE_FAIL,e.message)})},getUserProfileData:function(){var e=!1,t=document.getElementsByTagName("ev-em-profile-when"),n=localStorage.getItem("evolok:ev_session"),r=JSON.parse(JSON.parse(sessionStorage.getItem("evolok:ev_profile")))||{};if(n){var i,o=_createForOfIteratorHelper(t);try{for(o.s();!(i=o.n()).done;)"true"===i.value.getAttribute("getProfileEnable")&&(e=!0)}catch(e){o.e(e)}finally{o.f()}e?F.serviceName in r||(r=(n=JSON.parse(n)).guid,n=n.secureSession.sessionId,n="Evolok evolok.api.service=".concat(F.serviceName," evolok.api.secureSessionId=").concat(n),fetch("https://".concat(F.icDomain,"/userProfile/").concat(r,"?serviceName=").concat(F.serviceName),{method:"GET",headers:{"Content-Type":"application/xml",Accept:"application/json",Authorization:n}}).then(function(e){return 200===e.status?e.json():void G.Em.publish(G.Em.Event.GET_PROFILE_DATA_FAIL,e.status)}).then(function(e){!function(e,t){console.log(e),console.log(t);var n={};n[t]=e,console.log(n),sessionStorage.setItem("evolok:ev_profile",JSON.stringify(JSON.stringify(n)))}(e.userProfile,F.serviceName),G.Em.publish(G.Em.Event.GET_PROFILE_DATA_SUCCESS,e)}).catch(function(e){return G.Em.publish(G.Em.Event.GET_PROFILE_DATA_FAIL,e.message)})):G.Em.publish(G.Em.Event.GET_PROFILE_DATA_SUCCESS,"re-render")}},updateAttributes:(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,l,c;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(!document.cookie.match(new RegExp("(^| )ev_ss=([^;]+)"))){e.next=4;break}n=document.cookie.match(new RegExp("(^| )ev_ss=([^;]+)"))[2],e.next=6;break;case 4:return console.warn("Evolok Session not found, impossible to update user attributes"),e.abrupt("return");case 6:return r="Evolok evolok.api.service=".concat(F.profileServiceName," evolok.api.sessionId=").concat(n),e.next=9,fetch("https://".concat(F.domainName,"/ic/api/session/").concat(n),{method:"GET",headers:{"Content-Type":"application/json",Authorization:r}});case 9:return i=e.sent,e.next=12,i.text().then(function(e){return(new DOMParser).parseFromString(e,"text/xml").getElementsByTagName("guid")[0].innerHTML});case 12:for(i=e.sent,o={attributes:[]},a=0,s=Object.entries(t);a<s.length;a++)c=_slicedToArray(s[a],2),l=c[0],c=c[1],c={name:l,value:c},o.attributes.push(c);fetch("https://".concat(F.domainName,"/ic/api/userProfile/").concat(i,"/").concat(F.profileServiceName),{method:"PUT",headers:{"Content-Type":"application/json",Authorization:r},body:JSON.stringify(o)}).then(function(e){200===e.status?G.Em.publish(G.Em.Event.UPDATE_PROFILE_SUCCESS,e.status):G.Em.publish(G.Em.Event.UPDATE_PROFILE_FAIL,e.status)}).catch(function(e){return G.Em.publish(G.Em.Event.UPDATE_PROFILE_FAIL,e.message)});case 16:case"end":return e.stop()}},e)})),function(e){return t.apply(this,arguments)}),authorize:function(e,t,n){G.Em.assert(e,"Parameters should not be empty!"),G.Em.assert(t,"Success callback should not be empty!"),G.Em.assert(n,"Error callback should not be empty!");var r=e?JSON.parse(e):{};Object.keys(r).forEach(function(e){r[e]=""+r[e]}),!r.hasOwnProperty("referer")&&document.referrer&&(r.referer=document.referrer),!r.hasOwnProperty("title")&&document.title&&(r.title=document.title),!r.hasOwnProperty("article_url")&&window.location.href&&(r.article_url=window.location.href),G.Em.publish(G.Em.Event.ARTICLE_DATA,{articleUrl:r[this.articleUrlKey],articleId:r[this.articleIdKey]}),F.brand?r.brand=F.brand:e.site&&(r.brand=e.site);var i=new URLSearchParams(window.location.search);if(i.has(this.qrCodeQueryParam)&&(e=(e=i.get(this.qrCodeQueryParam)).split(" ").join("+"),r[this.qrCodeQueryParam]=e),i.has(this.shareArticleTokenQueryParam)&&(l=(l=i.get(this.shareArticleTokenQueryParam)).split(" ").join("+"),r[this.shareArticleTokenQueryParam]=l),F.authorizeParams){var o,a=_createForOfIteratorHelper(F.authorizeParams);try{for(a.s();!(o=a.n()).done;){var s=o.value;i.has(s)&&(r[s]=i.get(s))}}catch(e){a.e(e)}finally{a.f()}}r.ev_sid="",r.ev_did="",r.ev_ss="",!F.disableCookies&&v("ev_sid")?(r.ev_sid=j("ev_sid"),b("ev_sid",j("ev_sid"),0,"localStorage")):!F.disableCookies&&g("ev_sid")&&(F.meterHD?!0===F.meterHD&&(f("ev_sid",q("ev_sid","localStorage")),r.ev_sid=q("ev_sid","localStorage"),F.meterHD):f("ev_sid",q("ev_sid","localStorage"))),!F.disableCookies&&v("ev_did")?(r.ev_did=j("ev_did"),b("ev_did",j("ev_did"),0,"localStorage")):!F.disableCookies&&g("ev_did")&&(F.meterHD?!0===F.meterHD&&(f("ev_did",q("ev_did","localStorage")),r.ev_did=q("ev_did","localStorage")):f("ev_did",q("ev_did","localStorage"))),""!==j("ev_ss")&&(r.ev_ss=j("ev_ss"));var l=_("/authorize/json",null),c=new XMLHttpRequest;c.open("POST",l,!0),c.setRequestHeader("Content-Type","application/json;charset=UTF-8"),c.withCredentials=!0,c.onload=function(){var e;200<=c.status&&c.status<400?(e={},200!==c.status||c.responseText?e=JSON.parse(c.responseText):e.result="ALLOW_ACCESS",m.resolve(e),p.authorizeData=e,console.log(e),e.sessionKeys?(e.sessionKeys.ev_sid&&(u=e.sessionKeys.ev_sid,h()),e.sessionKeys.ev_did&&(d=e.sessionKeys.ev_did,e.deviceId=e.sessionKeys.ev_did,h())):e.deviceId=j("ev_did"),G.Em.articleSharingHandler(e),G.Em.paywallAndNotifierEvents(e),"REQUIRE_LOGIN"===e.result&&G.Event&&(""!==j("ev_ss")&&G.Event.publish("session.cleanup","Session has expired"),G.Event.publish("login.required","Login is required")),"ALLOW_ACCESS"!=e.result&&G.Em.hideMeteredContent(),G.Em.GTMDataLayerEnabled&&(window.dataLayer=window.dataLayer||[],window.dataLayer.push({evAuthResponse:e})),!e.loggedOut&&void 0!==e.loggedOut||G.Em.publish(G.Em.Event.PROFILE_ACCESS_RENDER_STATUS,"LoggedOut"),e.loggedOut||void 0===e.loggedOut||G.Em.publish(G.Em.Event.PROFILE_ACCESS_RENDER_STATUS,"LoggedIn"),t(e)):(n&&n(c.status,c.responseText),G.Em.publish(G.Em.Event.PROFILE_ACCESS_RENDER_STATUS,"LoggedOut"))},c.onerror=function(e){e?n(e):n(0,"unknown connection error")},c.send(JSON.stringify(r))},initDwellTimeRequests:function(t){var n=window.setInterval(function(){var e;document.hidden||(e=30*i+30,t.dwellTimeInterval=e,G.Em.paywallAndNotifierEvents(t),i++),i==s&&clearInterval(n)},3e4)},articleSharingHandler:function(e){var t,n=null!=e.articleSharingEnabled&&!0===e.articleSharingEnabled,r=_createForOfIteratorHelper(document.querySelectorAll("ev-share-article-btn"));try{for(r.s();!(t=r.n()).done;)t.value.style.display=n?"block":"none"}catch(e){r.e(e)}finally{r.f()}},paywallAndNotifierEvents:function(e){function t(e){G.Em.publish(G.Em.Event.AD_AUTHORIZE,e)}"ALLOW_ACCESS"!==e.result||e.articleSharingEvent||n||G.Em.publish(G.Em.Event.DWELLTIME_CHECK,{}),t(e),window.addEventListener("ev.widgets.paywall.load",function(){t(e)}),window.addEventListener("ev.widgets.notifier.load",function(){t(e)})},pretty_print:function(e){return"<pre>"+JSON.stringify(e,null,3).replace(/&/g,"&amp;").replace(/\\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/^( *)("[\w]+": )?("[^"]*"|[\w.+-]*)?([,[{])?$/gm,G.Em.replacer)+"</pre>"},replacer:function(e,t,n,r,i){t=t||"";return n&&(t=t+"<span class=json-key>"+n.replace(/[": ]/g,"")+"</span>: "),(t=r?t+('"'==r[0]?"<span class=json-string>":"<span class=json-value>")+r+"</span>":t)+(i||"")},segment:function(t,n,r){G.Em.assert(t,"Parameters should not be empty!"),G.Em.assert(n,"Success callback should not be empty!"),G.Em.assert(r,"Error callback should not be empty!");var t=_("/segment",function(e){var t,n="";for(t in e=JSON.parse(e))""!==n&&(n+="&"),n+=t+"="+encodeURIComponent(e[t]);return n}(t)),i=new XMLHttpRequest;i.open("GET",t,!0),i.withCredentials=!0,i.onload=function(){var e;200<=i.status&&i.status<400?(e=JSON.parse(i.responseText),a.resolve(e),n(e)):r&&r(i.status,i.responseText)},i.onerror=function(){e?r(e):r(0,"unknown connection error")},i.send()},assert:function(e,t){if(!e){if(t=t||"Assertion failed","undefined"!=typeof Error)throw new Error(t);throw t}},getUrl:function(){return F.url},showMeteredContent:function(){var e=document.getElementsByClassName("ev-meter-content");[].forEach.call(e,function(e){e.style.display="block"})},hideMeteredContent:function(){var e=document.getElementsByClassName("ev-meter-content");[].forEach.call(e,function(e){e.style.display="none"})}},setTimeout(function(){h()},4e3);var E=";SameSite=None; Secure";function f(e,t,n){if(!F.sidCookieDomain)throw new Error("Please specify sidCookieDomain in the config!",!0);var r=new Date;n=1460,r.setDate(r.getDate()+n),(o=y())&&o<13?(document.cookie=e+"="+escape(t)+";time="+new Date+";expires="+r.toUTCString()+";path=/; domain="+F.sidCookieDomain+"; Secure",console.log(e+"="+escape(t)+";time="+new Date+";expires="+r.toUTCString()+";path=/; domain="+F.sidCookieDomain+"; Secure")):(document.cookie=e+"="+escape(t)+";time="+new Date+";expires="+r.toUTCString()+";path=/; domain="+F.sidCookieDomain+E,console.log(e+"="+escape(t)+";time="+new Date+";expires="+r.toUTCString()+";path=/; domain="+F.sidCookieDomain+E))}function v(e){return""!==j(e)&&"undefined"!==j(e)&&j(e)}function g(e){return""!==q(e,"localStorage")&&"undefined"!==q(e,"localStorage")&&q(e,"localStorage")}function y(){var e=navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/);return null!=e&&(e=[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3]||0,10)],parseFloat(e.join(".")))}function q(e,t){var n=document.cookie.indexOf(e+"=");if("localStorage"==t){if("undefined"==typeof localStorage)return 0<document.cookie.length&&-1!==n?getCookieSubstring(n,e):"";try{return localStorage.getItem(e)}catch(e){return console.warn("Could not retrieve the cookie in local storage - maybe the browser's running on an environment with restricted access to localStorage?"),"undefined"}}if("sessionStorage"==t){if("undefined"==typeof sessionStorage)return n=document.cookie.indexOf(e+"="),0<document.cookie.length&&-1!==n?getCookieSubstring(n,e):"";console.log(sessionStorage.getItem(e));try{return sessionStorage.getItem(e)}catch(e){return console.warn("Could not retrieve the cookie in session storage - maybe the browser's running on an environment with restricted access to sessionStorage?"),"undefined"}}}function b(e,t,n,r){var i=new Date;if("localStorage"==r)if(i.setDate(i.getDate()+n),"undefined"!=typeof localStorage)try{localStorage.setItem(e,t)}catch(e){console.warn("Could not store the cookie in local storage - maybe the browser's running on an environment with restricted access to localStorage?")}else o=y(),document.cookie=o&&o<13?e+"="+escape(t)+(null===n?"":";time="+new Date+";expires="+i.toUTCString())+"; Secure":e+"="+escape(t)+(null===n?"":";time="+new Date+";expires="+i.toUTCString())+E;if("sessionStorage"==r)if(i.setDate(i.getDate()+n),"undefined"!=typeof sessionStorage)try{sessionStorage.setItem(e,t)}catch(e){console.warn("Could not store the cookie in session storage - maybe the browser's running on an environment with restricted access to sessionStorage?")}else o=y(),document.cookie=o&&o<13?e+"="+escape(t)+(null===n?"":";time="+new Date+";expires="+i.toUTCString())+"; Secure":e+"="+escape(t)+(null===n?"":";time="+new Date+";expires="+i.toUTCString())+E}function S(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;"}function _(e,t){!function(){if(!F)throw"Evolok Metering library is not initialised!"}();var n=F.url;if(!n)throw new Error("Evolok Metering host url is not configured!");return"/"===n.charAt(n.length-1)&&"/"===e.charAt(0)?n+=e.substring(1,e.length):n+=e,n=t?n+"?"+t:n}function w(){var n=this;this.promise=new Promise(function(e,t){n.reject=t,n.resolve=e})}window.customElements.define("ev-engagement",function(){_inherits(n,_wrapNativeSuper(HTMLElement));var t,e=_createSuper(n);function n(){return _classCallCheck(this,n),e.apply(this,arguments)}return _createClass(n,[{key:"registerCloseModal",value:function(){var t=this;"notifier"===this.widgetType?(this.allowBackgroundClickClosing()&&(window.onclick=function(e){"ev-em-modal-backdrop"===e.target.id&&t.closeModal()}),G.Em.on(G.Em.Event.NOTIFIER_CLOSE,this.closeModal.bind(this))):G.Em.on("ev.em.paywall.close",this.closeModal.bind(this))}},{key:"allowBackgroundClickClosing",value:function(){return null==this.getAttribute("modal-backdrop")||"false"!==this.getAttribute("modal-backdrop")}},{key:"getGroupName",value:function(){return this.getAttribute("group-name")}},{key:"closeModal",value:function(){null!=document.querySelector("#engagement-top")&&document.querySelector("#engagement-top").parentElement.remove(),document.body.style.overflow=null}},{key:"setModalContent",value:function(){window.closeModal=this.closeModal;var e=document.createElement("div");document.body.prepend(e),document.body.style.overflow="hidden",e.innerHTML='\n                <div id="engagement-top" class="ev-em-modals ev-em-modal">\n                    <div class="ev-em-modal-dialog ev-em-modal-'.concat(this.widgetResponse.modalSize,'">\n                        <div class="ev-em-modal-content">\n                            <div class="ev widget-container ev-engagement">\n                                <div class="ev-').concat(this.widgetType,'-template">\n                                    ').concat(this.widgetResponse.content,'\n                                </div>\n                            </div>\n                        </div>\n                    </div>\n                    <div id="ev-em-modal-backdrop" class="ev-em-modal-backdrop"></div>\n                </div>'),this.renderContent()}},{key:"setInlineContent",value:function(){this.innerHTML='\n                        <div class="ev widget-container ev-engagement">\n                            <div class="ev-'.concat(this.widgetType,'-template">\n                                ').concat(this.widgetResponse.content,"\n                            </div>\n                        </div>"),this.renderContent()}},{key:"renderContent",value:function(){var e;null==G.Widgets||"function"!=typeof G.Widgets.asyncInit||this.isArticleSharingEngagement?this.publishRenderedEvents():(e=this,G.Widgets.asyncInit().then(function(){console.log("EV widgets initialized from ev-em library"),e.publishRenderedEvents()}));for(var t=document.querySelectorAll("script[data-ev-engagement]"),n=0;n<t.length;n++){var r=t[n],i=document.createElement("script");i.innerHTML=r.text,document.body.appendChild(i)}}},{key:"publishRenderedEvents",value:function(){var e={ev_sid:this.ev_sid,template:this.widgetResponse},t="notifier"===this.widgetType?G.Em.Event.NOTIFIER_MODAL_RENDERED:G.Em.Event.PAYWALL_MODAL_RENDERED;G.Em.publish(t,e)}},{key:"connectedCallback",value:function(){var e=this.getAttribute("article-sharing");this.isArticleSharingEngagement=null!=e&&"true"===e;r?this.internalWidgetDisplay(r):G.Em.on(G.Em.Event.AD_AUTHORIZE,this.internalWidgetDisplay.bind(this)),this.isArticleSharingEngagement?G.Em.on(G.Em.Event.CLOSE_ARTICLE_SHARING_MODAL,this.closeModal.bind(this)):G.Em.enableDwellTime&&G.Em.on(G.Em.Event.DWELLTIME_CHECK,this.dwellTimeCheckEvents.bind(this))}},{key:"internalWidgetDisplay",value:(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,r,i,o,a,s,l,c,u;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(G.Em.enableDwellTime&&this.blockDwellTimeRequests)return e.abrupt("return");e.next=2;break;case 2:if(n=t.detail,this.isArticleSharingEngagement&&!n.articleSharingEvent||!this.isArticleSharingEngagement&&n.articleSharingEvent)return e.abrupt("return");e.next=5;break;case 5:if(n.articleUrl&&(this.articleUrl=n.articleUrl,this.articleId=n.articleId),this.ev_sid=n.sessionId||n.restoredSessionId,r=n.deviceId||j("ev_did")||q("ev_did","localStorage"),i=n.hasOwnProperty("loggedOut")&&!1===n.loggedOut,o=n.hasOwnProperty("abGroup")?n.abGroup.name:null,a=n.hasOwnProperty("abGroup")?n.abGroup.value:null,s=(s=this.getMeter(n))||{count:null,max:null},!this.isArticleSharingEngagement||null==this.widgetResponse){e.next=17;break}l=this.widgetResponse,e.next=29;break;case 17:if("ALLOW_ACCESS"===n.result)return c=n.dwellTimeInterval,e.next=21,this.getNotifierWidget(s,n.segments||[],r,c,i,o,a);e.next=24;break;case 21:l=e.sent,e.next=29;break;case 24:return this.blockDwellTimeRequests=!0,u=n.requireEntitlement?"REQUIRE_LOGIN_WITH_ENTITLEMENT":"REQUIRE_LOGIN"===n.result?"REQUIRE_LOGIN":"REQUIRE_ENTITLEMENT",e.next=28,this.getPaywallWidget(s,u,n.segments||[],r,i,o,a);case 28:l=e.sent;case 29:l&&(this.widgetResponse=l,u="notifier"===this.widgetType?G.Em.Event.NOTIFIER_MODAL_RENDERED:G.Em.Event.PAYWALL_MODAL_RENDERED,G.Em.on(u,this.initLinkTracking.bind(this)),l.autoRender&&this.displayEngagement());case 30:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})},{key:"getMeter",value:function(e){return e.activeMeter||e.exceededMeter||e.offeredMeter}},{key:"displayEngagement",value:function(){var e;this.notifierDisplayed&&!this.isArticleSharingEngagement||(this.trackDwellTime||(this.notifierDisplayed=!0),null!=this.widgetResponse.dwellTime&&0<this.widgetResponse.dwellTime&&this.closeModal(),e="notifier"===this.widgetType?G.Em.Event.NOTIFIER_OPENED:G.Em.Event.PAYWALL_OPENED,G.Em.publish(e,this.widgetResponse),G.Em.publish("ev.em.open.modal.".concat(this.widgetType,".").concat(this.widgetResponse.displayOn)),this.widgetResponse.modal?(this.setModalContent(),this.registerCloseModal()):this.setInlineContent(),G.Em.publish(G.Em.Event.ARTICLE_URL,{articleUrl:this.articleUrl,articleId:this.articleId}),G.Em.publish(G.Em.Event.OPEN_PRODUCT_SELECTION,this))}},{key:"getPaywallWidget",value:function(e,t,n,r,i,o,a){var s=this,r="".concat(F.url,"/widgets/templates/paywall?ev_sid=").concat(this.ev_sid,"&ev_did=").concat(r),a={count:e.count,total:e.max,displayOn:t,segments:n,groupName:this.getGroupName(),loggedIn:i,brand:G.Em.brand,abGroupName:o,abGroupValue:a};return this.post(r,a).then(function(e){return e&&(s.widgetType="paywall",s.handleManualRenderEvents(e,"paywall")),e})}},{key:"getNotifierWidget",value:function(e,t,n,r,i,o,a){var s=this,n="".concat(F.url,"/widgets/templates/notifier?ev_sid=").concat(this.ev_sid,"&ev_did=").concat(n),a={count:e.count,total:e.max,segments:t,dwellTime:r,groupName:this.getGroupName(),loggedIn:i,brand:G.Em.brand,abGroupName:o,abGroupValue:a};return e.hasOwnProperty("viewed")&&(a.viewed=e.viewed),this.post(n,a).then(function(e){return e&&(s.widgetType="notifier",s.handleManualRenderEvents(e,"notifier")),e})}},{key:"post",value:function(e,t){return fetch(e,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)}).then(function(e){return 200===e.status?e.json():null})}},{key:"handleManualRenderEvents",value:function(e,t){var n;e.hasOwnProperty("autoRender")&&!1===e.autoRender&&(n="notifier"===t?G.Em.Event.NOTIFIER_SHOW_CTA:G.Em.Event.PAYWALL_SHOW_CTA,G.Em.on(n,this.displayEngagement.bind(this)));t="notifier"===t?G.Em.Event.NOTIFIER_RENDER_READY:G.Em.Event.PAYWALL_RENDER_READY;G.Em.publish(t,e)}},{key:"initLinkTracking",value:function(e){var t,n=e.detail,r=_createForOfIteratorHelper(document.querySelector(".ev-engagement").querySelectorAll("a[href]"));try{for(r.s();!(t=r.n()).done;){var i=t.value;i.dataset.widgetuid=n.template.uid,i.dataset.sessionid=n.ev_sid,i.addEventListener("click",this.trackLink.bind(this))}}catch(e){r.e(e)}finally{r.f()}}},{key:"trackLink",value:function(e){e.preventDefault();var t=e.target,n=(t="a"!==t.tagName.toLowerCase()?t.closest("a"):t).innerText,r=t.href,e=t.dataset.widgetuid,t=t.dataset.sessionid;this.storeLinkTracking(t,e,n,r).then(function(e){window.location=r}).catch(function(e){console.log(e),window.location=r})}},{key:"storeLinkTracking",value:function(e,t,n,r){e="".concat(F.url,"/widgets/templates/linkTracking?ev_sid=").concat(e);return this.post(e,{templateUid:t,linkName:n,linkValue:r})}},{key:"dwellTimeCheckEvents",value:function(){var t=this,n={dwellTimeTrackingEnabled:!1};this.checkDwellTimeWidgetsActive().then(function(e){e?(t.trackDwellTime=!0,n.dwellTimeTrackingEnabled=!0,n.maxDwellTimeRequests=e.maxDwellTimeRequests||3):console.warn("No dwell time widgets found"),G.Em.publish(G.Em.Event.DWELLTIME_WIDGETS_ENABLED,n)}).catch(function(e){console.error("Error checking dwell time widgets:",e)})}},{key:"checkDwellTimeWidgetsActive",value:function(){var e="".concat(F.url,"/widgets/templates/dwellTime?groupName=").concat(this.getGroupName());return fetch(e,{headers:{"Content-Type":"application/json"}}).then(function(e){return 200===e.status?e.json():null})}}]),n}()),window.customElements.define("ev-content-recommendations",function(){_inherits(n,_wrapNativeSuper(HTMLElement));var e,t=_createSuper(n);function n(){return _classCallCheck(this,n),t.apply(this,arguments)}return _createClass(n,[{key:"connectedCallback",value:(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t,n,r,i;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=null!=this.getAttribute("all-brands")&&"true"===this.getAttribute("all-brands"),n=this.getAttribute("query-params"),r=j("ev_sid")||q("ev_sid","localStorage"),r="".concat(F.url,"/content/recommendations?ev_sid=").concat(r),!t&&G.Em.brand&&(r+="&brand=".concat(G.Em.brand)),F.recency&&(r+="&recency=".concat(F.recency)),F.section&&(r+="&section=".concat(F.section)),e.next=9,fetch(r).then(function(e){return 200===e.status?e.json():null});case 9:r=e.sent,i="",r.recommendations.forEach(function(e){n&&(e.contentUrl=(e.contentUrl.includes("?")?"".concat(e.contentUrl,"&"):"".concat(e.contentUrl,"?")).concat(n)),i+='\n                <article class="ev-content-item">\n                    <div class="ev-content-item-thumbnail">\n                        '.concat(e.thumbnailUrl?'\n                            <img src="'.concat(e.thumbnailUrl,'" width="120" height="67">                           \n                        '):"",'\n                    </div>\n                    <div class="ev-content-item-title">\n                        <a href="').concat(e.contentUrl,'">').concat(e.title,'</a>\n                    </div>\n\x3c!--                    <div class="ev-em-product-selection">This is aa sen</div>--\x3e\n                   \n                </article>\n            ')}),this.innerHTML='\n                <div class="ev-content-recommendations">\n                    '.concat(i,"\n                </div>");case 13:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})}]),n}()),window.customElements.define("ev-em-profile-when",function(){_inherits(t,_wrapNativeSuper(HTMLElement));var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"connectedCallback",value:function(){var e=this;for(this.customHtml=this.innerHTML;this.firstChild;)this.removeChild(this.firstChild);G.Em.on(G.Em.Event.PROFILE_ACCESS_RENDER_STATUS,this.initRenderElement.bind(this)),G.Em.on(G.Em.Event.GET_PROFILE_DATA_SUCCESS,function(){e.resetHtml("LoggedIn")}),G.Event&&G.Event.on(G.Event.LOGOUT_ACTION,function(){e.resetHtml("LoggedOut")})}},{key:"resetHtml",value:function(e){this.responseState=e,this.responseState===this.state&&(this.style.display="block"),this.responseState!==this.state&&(this.style.display="none");e=this.customHtml;for(this.tempFullHtmlStr=this.innerHTML;this.firstChild;)this.removeChild(this.firstChild);this.setCustomHtmlVar(),this.tempFullHtmlStr=this.tempFullHtmlStr.replace(e,this.customHtml),this.insertAdjacentHTML("beforeend",this.tempFullHtmlStr)}},{key:"setCustomHtmlVar",value:function(){if(this.userProfileData=sessionStorage.getItem("evolok:ev_profile"),this.userProfileData=JSON.parse(JSON.parse(this.userProfileData)),this.userProfileData){for(var n=this.customHtml,e=[],t=0,r=Object.entries(this.userProfileData);t<r.length;t++)var i=_slicedToArray(r[t],2),i=(i[0],i[1]),e=[].concat(_toConsumableArray(e),_toConsumableArray(i.attributes));(e=e.filter(function(t,e,n){return n.findIndex(function(e){return e.name===t.name})===e})).forEach(function(e){var t="user."+e.name;n.includes(t)&&(t=new RegExp(t,"g"),n=n.replace(t,e.value))}),this.customHtml=n}}},{key:"initRenderElement",value:function(e){this.responseState=e.detail,this.state=this.getAttribute("state"),this.state&&(this.setCustomHtmlVar(),this.mainParent=document.createElement("div"),this.responseState!==this.state&&(this.style.display="none"),this.responseState===this.state&&(this.style.display="block"),this.mainParent.className="container-fluid ev-em-profile-when",(e=document.createElement("div")).className="row",e.insertAdjacentHTML("beforeend",this.customHtml),this.mainParent.appendChild(e),this.appendChild(this.mainParent))}}]),t}()),window.customElements.define("ev-em-product-selection",function(){_inherits(r,_wrapNativeSuper(HTMLElement));var t,e,n=_createSuper(r);function r(){return _classCallCheck(this,r),n.apply(this,arguments)}return _createClass(r,[{key:"connectedCallback",value:(e=_asyncToGenerator(regeneratorRuntime.mark(function e(){return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:window.addEventListener("ev.ad.authorize",this.initRendering.bind(this)),G.Em.on(G.Em.Event.OPEN_PRODUCT_SELECTION,this.initRendering.bind(this));case 2:case"end":return e.stop()}},e,this)})),function(){return e.apply(this,arguments)})},{key:"initRendering",value:(t=_asyncToGenerator(regeneratorRuntime.mark(function e(t){var n,v,g,r,i,o,y,b,S,_,a,w,T,O,A,C,I,N,s,l,c,u,d,m,p,L,h,k,E,f,R,P,D,U,x,M,H=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(M=function(){return(M=_asyncToGenerator(regeneratorRuntime.mark(function e(){var t;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return t=l+"/countries",e.next=3,fetch(t).then(function(e){return 200===e.status?e.json():null}).then(function(e){return console.log("getCountries:",e),e});case 3:return e.abrupt("return",e.sent);case 4:case"end":return e.stop()}},e)}))).apply(this,arguments)},x=function(){return M.apply(this,arguments)},U=function(){return(U=_asyncToGenerator(regeneratorRuntime.mark(function e(t,n){var r;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return r=l+"/region/",r+=t?"?countryId="+t:"?countryName="+n,e.next=4,fetch(r).then(function(e){return 200===e.status?e.json():null}).then(function(e){return console.log("getRegion:",e),m=e});case 4:return e.abrupt("return",e.sent);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)},D=function(e,t){return U.apply(this,arguments)},P=function(){if(a)return x().then(function(e){e.find(function(e){return u&&u.country?e.id===u.country?e.name:void 0:e.name===d})&&D()})},R=function(e,t,n,r){e=r?Number(Number(e)+Number(r)).toFixed(2):e;var i=0,o=0;if(t&&0!==t.value)switch(t.type){case"PERCENTAGE":i=Number(Number(e)*Number(t.value)/100).toFixed(2);break;case"AMOUNT":i=Number(t.value).toFixed(2);break;default:throw"Discount type '"+t.type+"' is unknown!"}var a=Number(e)-Number(i);if(n&&0!==n.value)switch(n.type){case"PERCENTAGE":o=Number(Number(a)*Number(n.value)/100).toFixed(2);break;case"AMOUNT":o=Number(n.value).toFixed(2);break;default:throw"Tax type '"+n.type+"' is unknown!"}r=Number(a)+Number(o);return r<0?0:r},f=function(e,t){return R(e.price,e.discount&&0<e.discount.value&&0===e.discount.period.numberOfDays?e.discount:null,e.tax,t)},E=function(e,t){return!e.discount||e.discount&&0===e.discount.period.numberOfDays?0:R(e.price,e.discount,e.tax,t)},k=function(t){var e,n;return t.regions&&0<t.regions.length&&m?(n=m.deliveryItems.find(function(e){return e.currency.id===t.currency.id}))&&(e=(t.trialPrice?E:f)(t,n.deliveryCost)):e=t.trialPrice||t.finalPrice,e},h=function(e){var t=e.querySelector(".product-footer"),n=document.createElement("div");n.className="row product-footer-spacer";var r=window.getComputedStyle(t),r=parseInt(r.getPropertyValue("padding-bottom").replace("px",""));n.style.minHeight=t.offsetHeight+r+"px",e.insertBefore(n,t)},L=function(e){var t=0,n=document.querySelectorAll(e);if(e.includes("product-wrapper"))for(var r=0;r<n.length;r++)h(n[r]);Array.prototype.map.call(n,function(e){e.clientHeight>t&&(t=e.clientHeight)});for(var i=0;i<n.length;i++)n[i].style.minHeight=t+"px"},i=t.detail,n=i.sessionId||i.restoredSessionId||j("ev_sid")||q("ev_sid","localStorage"),c=F.pmUrl||this.getAttribute("pm-domain"),v=this.getAttribute("subscribe-url-prefix"),g=this.getAttribute("subscribe-btn-text")||"Select",r=this.getAttribute("product-name"),i=this.getAttribute("product-group"),o="true"===this.getAttribute("display-vertical-products"),y="true"===this.getAttribute("display-horizontal-plans"),b="true"===this.getAttribute("show-plan-name"),S="true"===this.getAttribute("hide-plan-description"),_=this.getAttribute("translation-plan-frequency")?JSON.parse(this.getAttribute("translation-plan-frequency").replace(/'/g,'"')):{NONE:"One-off",DAY1:"Daily",WEEK1:"Weekly",MONTH1:"Monthly",MONTH3:"Quarterly",MONTH6:"Biannual",MONTH12:"Yearly",MONTH18:"Sesquiennial"},a="true"===this.getAttribute("show-delivery-country"),w="true"===this.getAttribute("show-boosted-text"),T=this.getAttribute("basic-text")||"Basic Plan",O=this.getAttribute("recommended-text")||"Recommended",A="true"===this.getAttribute("auto-select"),I=this.getAttribute("button-url-prefix")||g,N=this.getAttribute("button-url-value")||"btn-selected",s=parseInt(this.getAttribute("product-limit"))||"All",l=c+"/widget",c||v||r||i){e.next=34;break}throw"Metering Library Error: Trying to use product selection but check that all required attributes are specified: [pm-domain, subscribe-url-prefix, product-name, product-group]";case 34:return c=new URLSearchParams(window.location.search),u=Object.fromEntries(c.entries()),d=u&&u.defaultCountry||this.getAttribute("default-country"),P(),r?p=l+"/product/".concat(r,"?ev_sid=").concat(n):i&&(p=l+"/productgroup/".concat(i,"?ev_sid=").concat(n)),e.next=41,fetch(p).then(function(e){return 200===e.status?e.json():null}).then(function(d){if(console.log("data",d),!d)throw"Metering Library Error: Product/s info is empty";var m=[];d.products?m=d.products:m.push(d),"All"!==s&&s&&m.splice(s);var p=document.createElement("div");p.className="container-fluid ev-em-product-selection";var h=document.createElement("div");h.className="row";var E,f=o?12:12/m.length,t=_createForOfIteratorHelper(m);try{var e=function(){var o=E.value,e=document.createElement("div");e.id="product-"+o.name,e.className="col-lg-"+f+" col-md-"+f+" col-sm-12 col-xs-12 product-item-container";var t=document.createElement("div");t.className="container-fluid product-wrapper";var n=document.createElement("div");n.className="row product-header",w&&o.id===d.recommended?(d.recommended,e.classList.add("recommended-product"),(r=document.createElement("div")).className="col-lg-12 col-md-12 col-sm-12 col-xs-12 product-boosted",r.innerText=O,n.appendChild(r)):w&&((l=document.createElement("div")).className="col-lg-12 col-md-12 col-sm-12 col-xs-12 product-basic",l.innerText=T,n.appendChild(l));var r=document.createElement("div");r.className="col-lg-12 col-md-12 col-sm-12 col-xs-12 product-title",r.innerText=o.displayName,n.appendChild(r),t.appendChild(n);var a=document.createElement("div");a.className="row product-body";var s,i=_createForOfIteratorHelper(o.paymentPlans);try{for(i.s();!(s=i.n()).done;)!function(){var n=s.value,e=y?12/o.paymentPlans.length:12,t=document.createElement("div");t.id="payment-plan-"+o.name+"-"+n.name,t.className="col-lg-"+e+" col-md-"+e+" col-sm-12 col-xs-12 payment-plan-container",A&&o.id===d.recommended?n.id===o.autoSelectPlan&&(C={planName:n.name,productName:o.name},t.classList.add("payment-plan-selected")):A&&!d.recommended&&(C||n.id!==o.autoSelectPlan&&1!==o.paymentPlans.length||(C={planName:n.name,productName:o.name},t.classList.add("payment-plan-selected")));var r=document.createElement("div");r.className="payment-plan-price";e=document.createElement("span");e.className="payment-currency-symbol",e.innerText=n.currency.symbol,r.innerHTML=e.outerHTML+k(n),t.appendChild(r);var i,r=document.createElement("div");r.className="payment-plan-frequency",r.innerText=_[n.frequency.id],t.appendChild(r),b&&((i=document.createElement("div")).className="payment-plan-name",i.innerText=n.displayName,t.appendChild(i)),S||((i=document.createElement("div")).className="payment-plan-description",i.innerText=n.description,t.appendChild(i)),t.addEventListener("click",function(e){C={planName:n.name,productName:o.name};var t=document.querySelector(".payment-plan-selected");t&&t.classList.remove("payment-plan-selected"),e.currentTarget.classList.add("payment-plan-selected")}),a.appendChild(t)}()}catch(e){i.e(e)}finally{i.f()}var l=document.createElement("div");l.className="row product-footer";r=document.createElement("div");r.className="col-lg-12 col-md-12 col-sm-12 col-xs-12";var n=document.createElement("button"),c=m.indexOf(o)+1;n.className="btn btn-default product-select-btn",n.innerText=g;var u=(v.includes("?")?"&":"?").concat(I,"=").concat(N).concat(c);n.addEventListener("click",function(){console.log("The select button ".concat(g," with index ").concat(c," was clicked!")),C&&C.productName===o.name?window.location=v+u+"&productName="+o.name+"&paymentPlans="+C.planName:window.location=v+u+"&productName="+o.name}),r.appendChild(n),l.appendChild(r),t.appendChild(a),t.appendChild(l),e.appendChild(t),h.appendChild(e),p.appendChild(h)};for(t.s();!(E=t.n()).done;)e()}catch(e){t.e(e)}finally{t.f()}H.appendChild(p),L(".payment-plan-container"),L(".product-wrapper"),G.Em.publish(G.Em.Event.PRODUCT_SELECTION_LOADED,m)});case 41:e.sent;case 42:case"end":return e.stop()}},e,this)})),function(e){return t.apply(this,arguments)})}]),r}()),window.customElements.define("ev-share-article-btn",function(){_inherits(t,_wrapNativeSuper(HTMLElement));var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"connectedCallback",value:function(){G.Em.on(G.Em.Event.ARTICLE_DATA,this.storeArticleData.bind(this));var e=this.getAttribute("widget-count");this.widgetCount=null!=e?parseInt(e):1;e=this.getAttribute("share-article-group");this.articleShareGroup=e||"ShareArticle";e=this.getAttribute("share-button-text");this.shareBtnText=e||"Share Article",this.innerHTML='\n                <div>\n                    <button class="share-article-btn">'.concat(this.shareBtnText,'</button>\n                </div>\n                <ev-engagement group-name="').concat(this.articleShareGroup,'" article-sharing="true"></ev-engagement>\n            '),this.style.display="none",this.querySelector(".share-article-btn").addEventListener("click",this.openShareArticleModal.bind(this))}},{key:"storeArticleData",value:function(e){console.log(e.detail),this.articleUrl=e.detail.articleUrl,this.articleId=e.detail.articleId}},{key:"openShareArticleModal",value:function(){console.log("share article button clicked");var e={result:"ALLOW_ACCESS",sessionId:j("ev_sid")||q("ev_sid","localStorage"),activeMeter:{count:this.widgetCount,max:100},articleSharingEvent:!0,articleUrl:this.articleUrl,articleId:this.articleId};G.Em.paywallAndNotifierEvents(e)}}]),t}()),window.customElements.define("ev-share-article",function(){_inherits(t,_wrapNativeSuper(HTMLElement));var e=_createSuper(t);function t(){return _classCallCheck(this,t),e.apply(this,arguments)}return _createClass(t,[{key:"connectedCallback",value:function(){G.Em.on(G.Em.Event.ARTICLE_URL,this.storeArticleUrl.bind(this));var e=this.getAttribute("hide-email-input");this.hideEmailInput=null!=e&&"true"===e;e=this.getAttribute("email-label-text");this.emailLabelText=e||"Recipient Email";e=this.getAttribute("share-button-text");this.shareButtonText=e||"Share",this.innerHTML='\n                <div class="ev-share-article-template">\n                    <div style="display: '.concat(this.hideEmailInput?"none":"block",'">\n                        <label for="articleShareEmail">').concat(this.emailLabelText,'</label>\n                        <input id="ev-article-share-email" type="text">\n                    </div>\n                    \n                    <button class="share-submit-btn">').concat(this.shareButtonText,"</button>\n                    \n                </div>"),this.querySelector(".share-submit-btn").addEventListener("click",this.shareArticle.bind(this))}},{key:"storeArticleUrl",value:function(e){this.articleUrl=e.detail.articleUrl,this.articleId=e.detail.articleId}},{key:"shareArticle",value:function(){var e=document.querySelector("#ev-article-share-email").value;G.Em.shareArticle({articleUrl:this.articleUrl,articleId:this.articleId,email:e})}}]),t}()),G.Em.on(G.Em.Event.AD_AUTHORIZE,function(e){r=e})}(window.EV);